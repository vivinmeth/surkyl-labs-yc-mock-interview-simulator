<!DOCTYPE html>
<html lang="en">
<head>
<title>YC Mock Interview • Surkyl</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" type="text/css" href="assets/styles/style.NWPDX9Fh.css" />
<link rel="icon" type="image/png" href="https://assets.muesync.com/common/images/labs-logo.png" />

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
<script type="text/javascript" src="assets/scripts/functions.NWPDX9Fh.js"></script>
<script type="text/javascript">
// Timer variables
var timer = 30;
var currentQuestionTime = 30;
var masterTimer = 600; // 10 minutes in seconds
var masterTimerInterval = null;
var questionStartTime = null;

// Question tracking
var totalQuestions = 0;
var answeredQuestions = 0;
var q = [];
var tips = [];
var isFirstQuestion = true;
var interviewFailed = false;
var interviewStartTime = null;
var currentQuestionText = "";

// First question constant
var FIRST_QUESTION = "What are you working on?";

// Metrics tracking
var attemptMetrics = {
	questions: [],
	totalScore: 0,
	averageTime: 0,
	perfectAnswers: 0,
	quickAnswers: 0,
	longAnswers: 0
};

// Scoring functions
function calculateScore(timeTaken, timeAllowed) {
	// For first question (30s): quick < 15s, perfect 15-22s, long > 22s
	// For other questions (20s): quick < 10s, perfect 10-15s, long > 15s
	var quickThreshold, perfectMaxThreshold;
	
	if (timeAllowed === 30) {
		quickThreshold = 15;
		perfectMaxThreshold = 22;
	} else {
		quickThreshold = 10;
		perfectMaxThreshold = 15;
	}
	
	if (timeTaken < quickThreshold) {
		return { score: 70, rating: 'quick', label: 'Quick but Brief' };
	} else if (timeTaken <= perfectMaxThreshold) {
		return { score: 100, rating: 'perfect', label: 'Perfect Timing' };
	} else {
		return { score: 85, rating: 'long', label: 'Detailed but Long' };
	}
}

function recordQuestionMetric(question, timeAllowed, timeTaken) {
	var result = calculateScore(timeTaken, timeAllowed);
	
	attemptMetrics.questions.push({
		question: question,
		timeAllowed: timeAllowed,
		timeTaken: timeTaken,
		score: result.score,
		rating: result.rating,
		label: result.label
	});
	
	// Update counters
	if (result.rating === 'quick') attemptMetrics.quickAnswers++;
	else if (result.rating === 'perfect') attemptMetrics.perfectAnswers++;
	else if (result.rating === 'long') attemptMetrics.longAnswers++;
}

function calculateFinalMetrics() {
	if (attemptMetrics.questions.length === 0) return;
	
	var totalScore = 0;
	var totalTime = 0;
	
	attemptMetrics.questions.forEach(function(q) {
		totalScore += q.score;
		totalTime += q.timeTaken;
	});
	
	attemptMetrics.totalScore = Math.round(totalScore / attemptMetrics.questions.length);
	attemptMetrics.averageTime = Math.round(totalTime / attemptMetrics.questions.length * 10) / 10;
}

// Load data from YAML file
async function loadData() {
	try {
		const response = await fetch('assets/data/data.yml');
		const yamlText = await response.text();
		const data = jsyaml.load(yamlText);
		
		q = data.questions || [];
		tips = data.tips || [];
		
		// Remove "What are you working on?" and similar variations from the pool
		q = q.filter(function(question) {
			var normalized = question.toLowerCase().trim();
			return normalized !== "what are you working on?" && 
				   normalized !== "so what are you working on?" &&
				   normalized !== "what are you working on";
		});
		
		// Randomise Questions & Tips
		q.sort(function() {return 0.5 - Math.random()});
		tips.sort(function() {return 0.5 - Math.random()});
		
		// Prepend the first question (always the same)
		q.unshift(FIRST_QUESTION);
		
		totalQuestions = q.length;
		
		// End Questions marker
		q.push('done');
		
		// Load attempt history
		loadAttemptHistory();
		
		// Initialize the app
		interviewStartTime = Date.now();
		next_q();
		timer_tick();
		start_master_timer();
		display_tip();
		updateProgress();
		
		// Hide loading state
		$('.loading-overlay').fadeOut(300);
		
	} catch (error) {
		console.error('Failed to load data:', error);
		$('#question').html('Failed to load questions. Please refresh the page.');
	}
}

// Master timer (10 minutes)
function start_master_timer() {
	update_master_timer_display();
	masterTimerInterval = setInterval(function() {
		if (interviewFailed) return;
		
		masterTimer--;
		update_master_timer_display();
		
		if (masterTimer <= 0) {
			clearInterval(masterTimerInterval);
			end_interview(true); // Time's up - but they completed the interview time
		}
	}, 1000);
}

function update_master_timer_display() {
	var minutes = Math.floor(masterTimer / 60);
	var seconds = masterTimer % 60;
	var display = minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
	$('#master-timer').text(display);
	
	// Warning states for master timer
	if (masterTimer <= 60) {
		$('#master-timer').addClass('timer-critical');
	} else if (masterTimer <= 120) {
		$('#master-timer').addClass('timer-low');
	}
}

function end_interview(success) {
	if (interviewFailed) return;
	
	interviewFailed = true;
	clearInterval(masterTimerInterval);
	
	var attempt = {
		timestamp: interviewStartTime,
		questionsAnswered: answeredQuestions,
		totalTime: 600 - masterTimer,
		passed: success,
		failReason: success ? null : 'timeout',
		metrics: attemptMetrics
	};
	
	saveAttempt(attempt);
	
	if (success) {
		// Show success screen
		$('#question-container').addClass('hide');
		$('#timer-container').addClass('hide');
		$('.pg').addClass('hide');
		$('.tip-container').addClass('hide');
		$('.controls').addClass('hide');
		$('#end').removeClass('hide');
		updateEndScreen(attempt);
	} else {
		// Show failure screen
		show_failure_screen(attempt);
	}
}

function show_failure_screen(attempt) {
	$('#question-container').addClass('hide');
	$('#timer-container').addClass('hide');
	$('.pg').addClass('hide');
	$('.tip-container').addClass('hide');
	$('.controls').addClass('hide');
	
	$('#fail-questions-answered').text(attempt.questionsAnswered);
	$('#fail-time-elapsed').text(formatTime(attempt.totalTime));
	$('#fail-score').text(attempt.metrics.totalScore + '/100');
	$('#fail-perfect').text(attempt.metrics.perfectAnswers);
	$('#fail-quick').text(attempt.metrics.quickAnswers);
	$('#fail-long').text(attempt.metrics.longAnswers);
	
	$('#failed').removeClass('hide');
}

function updateEndScreen(attempt) {
	$('#end-questions-answered').text(attempt.questionsAnswered);
	$('#end-time-elapsed').text(formatTime(attempt.totalTime));
	$('#end-score').text(attempt.metrics.totalScore + '/100');
	$('#end-avg-time').text(attempt.metrics.averageTime + 's');
	$('#end-perfect').text(attempt.metrics.perfectAnswers);
	$('#end-quick').text(attempt.metrics.quickAnswers);
	$('#end-long').text(attempt.metrics.longAnswers);
}

function formatTime(seconds) {
	var mins = Math.floor(seconds / 60);
	var secs = seconds % 60;
	return mins + 'm ' + secs + 's';
}

// LocalStorage functions
function saveAttempt(attempt) {
	var attempts = JSON.parse(localStorage.getItem('yc_interview_attempts') || '[]');
	attempts.push(attempt);
	localStorage.setItem('yc_interview_attempts', JSON.stringify(attempts));
	updateAttemptCounter();
}

function loadAttemptHistory() {
	updateAttemptCounter();
}

function updateAttemptCounter() {
	var attempts = JSON.parse(localStorage.getItem('yc_interview_attempts') || '[]');
	var totalAttempts = attempts.length;
	var passedAttempts = attempts.filter(function(a) { return a.passed; }).length;
	
	$('#attempt-count').text('Attempt #' + (totalAttempts + 1));
	if (totalAttempts > 0) {
		$('#attempt-stats').text(passedAttempts + '/' + totalAttempts + ' passed').removeClass('hide');
	}
}

$(document).ready(function(){
	loadData();
});

$(document).keypress(function(e) {
	if (interviewFailed) return;
	
	switch (e.which)
	{
		case 13:
			// Next Question - Return (13)
			if (q.length > 0 && !interviewFailed) next_q();
			break;

		case 32:
			// Next Question - Space (32)
			e.preventDefault();
			if (q.length > 0 && !interviewFailed) next_q();
			break;

		case 110:
			// Easter Egg
			$('body').append('<div class="egg"><iframe width="420" height="315" src="http://www.youtube.com/embed/QH2-TGUlwu4?autoplay=1" frameborder="0" allowfullscreen></iframe></div>');
			break;
	}
});

// Handle Escape key for canceling attempt
$(document).keydown(function(e) {
	if (e.which === 27 && !interviewFailed) {
		// ESC key - cancel attempt
		cancel_attempt();
	}
});

function cancel_attempt() {
	interviewFailed = true;
	clearInterval(masterTimerInterval);
	
	$('#question-container').addClass('hide');
	$('#timer-container').addClass('hide');
	$('.pg').addClass('hide');
	$('.tip-container').addClass('hide');
	$('.controls').addClass('hide');
	
	$('#canceled').removeClass('hide');
}

function updateProgress() {
	var progress = (answeredQuestions / totalQuestions) * 100;
	$('.progress-fill').css('width', progress + '%');
	$('.progress-text').text(answeredQuestions + ' / ' + totalQuestions);
}
</script>

</head>
<body>

<!-- Loading Overlay -->
<div class="loading-overlay">
	<div class="loading-content">
		<div class="loading-spinner"></div>
		<p>Loading questions...</p>
	</div>
</div>

<!-- Background Effects -->
<div class="bg-gradient"></div>
<div class="bg-grid"></div>

<!-- Header -->
<header class="header">
	<div class="logo">
		<img src="https://assets.muesync.com/common/images/labs-logo.png" alt="Surkyl Labs"  width="32" height="32"/>
		<span>YC Interview Simulator</span>
	</div>
	<div class="header-center">
		<div class="master-timer-container">
			<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
				<circle cx="12" cy="12" r="10"/>
				<polyline points="12 6 12 12 16 14"/>
			</svg>
			<span id="master-timer">10:00</span>
		</div>
		<div class="attempt-info">
			<span id="attempt-count">Attempt #1</span>
			<span id="attempt-stats" class="hide"></span>
		</div>
	</div>
	<a href="https://surkyl.com" target="_blank" rel="noopener" class="header-badge">
		by Surkyl Labs
		<img src="https://assets.muesync.com/common/images/labs-logo.png" alt="Surkyl Labs"  width="18" height="18"/>
	</a>
</header>

<!-- Progress Bar -->
<div class="progress-bar">
	<div class="progress-fill"></div>
	<span class="progress-text">0 / 0</span>
</div>

<!-- Main Content -->
<main class="main-content">
	
	<!-- Message to be Displayed when out of questions or time's up (Success) -->
	<div id="end" class="hide">
		<div class="end-content">
			<div class="end-icon success">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
					<polyline points="22 4 12 14.01 9 11.01"/>
				</svg>
			</div>
			<h1>Congratulations!</h1>
			<div class="result-stats">
				<div class="stat">
					<span class="stat-value" id="end-questions-answered">0</span>
					<span class="stat-label">Questions Answered</span>
				</div>
				<div class="stat">
					<span class="stat-value" id="end-time-elapsed">0m 0s</span>
					<span class="stat-label">Time Elapsed</span>
				</div>
				<div class="stat">
					<span class="stat-value score-value" id="end-score">0/100</span>
					<span class="stat-label">Overall Score</span>
				</div>
			</div>
			<div class="timing-breakdown">
				<div class="timing-stat perfect">
					<span class="timing-count" id="end-perfect">0</span>
					<span class="timing-label">Perfect (10-15s)</span>
				</div>
				<div class="timing-stat quick">
					<span class="timing-count" id="end-quick">0</span>
					<span class="timing-label">Quick (&lt;10s)</span>
				</div>
				<div class="timing-stat long">
					<span class="timing-count" id="end-long">0</span>
					<span class="timing-label">Long (&gt;15s)</span>
				</div>
			</div>
			<p class="avg-time">Average answer time: <strong id="end-avg-time">0s</strong></p>
			<p class="success-message">You successfully completed your mock interview! Best of luck with your actual YC interview - you've got this!</p>
			<div class="success-actions">
				<button class="btn-secondary" onclick="showAnalytics()">
					<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<line x1="18" y1="20" x2="18" y2="10"/>
						<line x1="12" y1="20" x2="12" y2="4"/>
						<line x1="6" y1="20" x2="6" y2="14"/>
					</svg>
					View Details
				</button>
				<button class="btn-restart" onclick="location.reload()">
					<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<polyline points="23 4 23 10 17 10"/>
						<path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
					</svg>
					Start New Attempt
				</button>
			</div>
		</div>
	</div>
	
	<!-- Interview Failed Screen -->
	<div id="failed" class="hide">
		<div class="end-content">
			<div class="end-icon failed">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<circle cx="12" cy="12" r="10"/>
					<line x1="15" y1="9" x2="9" y2="15"/>
					<line x1="9" y1="9" x2="15" y2="15"/>
				</svg>
			</div>
			<h1>Interview Failed</h1>
			<div class="result-stats">
				<div class="stat">
					<span class="stat-value" id="fail-questions-answered">0</span>
					<span class="stat-label">Questions Answered</span>
				</div>
				<div class="stat">
					<span class="stat-value" id="fail-time-elapsed">0m 0s</span>
					<span class="stat-label">Time Elapsed</span>
				</div>
				<div class="stat">
					<span class="stat-value score-value" id="fail-score">0/100</span>
					<span class="stat-label">Score Before Fail</span>
				</div>
			</div>
			<div class="timing-breakdown">
				<div class="timing-stat perfect">
					<span class="timing-count" id="fail-perfect">0</span>
					<span class="timing-label">Perfect</span>
				</div>
				<div class="timing-stat quick">
					<span class="timing-count" id="fail-quick">0</span>
					<span class="timing-label">Quick</span>
				</div>
				<div class="timing-stat long">
					<span class="timing-count" id="fail-long">0</span>
					<span class="timing-label">Long</span>
				</div>
			</div>
			<p>You ran out of time on a question. In a real YC interview, you need to answer quickly and concisely. Practice more!</p>
			<div class="fail-actions">
				<button class="btn-secondary" onclick="showAnalytics()">
					<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<line x1="18" y1="20" x2="18" y2="10"/>
						<line x1="12" y1="20" x2="12" y2="4"/>
						<line x1="6" y1="20" x2="6" y2="14"/>
					</svg>
					View Details
				</button>
				<button class="btn-restart" onclick="location.reload()">
					<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<polyline points="23 4 23 10 17 10"/>
						<path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
					</svg>
					Try Again
				</button>
			</div>
		</div>
	</div>
	
	<!-- Interview Canceled Screen -->
	<div id="canceled" class="hide">
		<div class="end-content">
			<div class="end-icon canceled">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M18 6L6 18M6 6l12 12"/>
				</svg>
			</div>
			<h1>Attempt Canceled</h1>
			<p class="joke-text">Do not worry, smarter people than you have tried and failed. Come back and try again any time!</p>
			<button class="btn-restart" onclick="location.reload()">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<polyline points="23 4 23 10 17 10"/>
					<path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
				</svg>
				Try Again
			</button>
		</div>
	</div>

	<!-- Question Display -->
	<div id="question-container">
		<div class="question-label">
			<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
				<circle cx="12" cy="12" r="10"/>
				<path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
				<line x1="12" y1="17" x2="12.01" y2="17"/>
			</svg>
			Question
		</div>
		<div id="question">&nbsp;</div>
	</div>

	<!-- Timer -->
	<div id="timer-container">
		<div class="timer-ring">
			<svg viewBox="0 0 100 100">
				<circle class="timer-bg" cx="50" cy="50" r="45"/>
				<circle class="timer-progress" cx="50" cy="50" r="45"/>
			</svg>
			<div id="timer">20</div>
		</div>
		<div class="timer-label">seconds remaining</div>
	</div>

	<!-- Disappointed Paul Graham -->
	<div class="pg hide">
		<div class="pg-overlay">
			<img src="assets/images/pg.jpg" alt="Paul Graham is disappointed" />
			<p>Time's up! Paul Graham is disappointed.</p>
		</div>
	</div>

</main>

<!-- Tips Display -->
<div class="tip-container">
	<div class="tip">
		<div class="tip-icon">
			<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
				<circle cx="12" cy="12" r="10"/>
				<line x1="12" y1="16" x2="12" y2="12"/>
				<line x1="12" y1="8" x2="12.01" y2="8"/>
			</svg>
		</div>
		<div class="tip-content">
			<strong>Pro Tip</strong>
			<span id="tip">&nbsp;</span>
		</div>
	</div>
</div>

<!-- Keyboard Controls -->
<div class="controls">
	<div class="control-item">
		<kbd>Enter</kbd>
		<span>or</span>
		<kbd>Space</kbd>
		<span>Answer & next question</span>
	</div>
</div>

<!-- Footer -->
<footer class="footer">
	<div class="footer-left">
		v1 by <a href="https://jamescun.com/" target="_blank" rel="noopener">James Cunningham</a> & <a href="https://bio.link/colinhayhurst" target="_blank" rel="noopener">Colin Hayhurst</a> • Enhanced by <a href="https://surkyl.com" target="_blank" rel="noopener">Surkyl Labs</a> Team
	</div>
	<div class="footer-center">
		&copy; 2024 Surkyl. All rights reserved.
	</div>
	<div class="footer-right">
		<span class="app-name">YC Interview Simulator</span>
		<span class="version-tag">v2.0</span>
	</div>
</footer>

<!-- Analytics Modal -->
<div id="analytics-modal" class="modal hide" x-data="analyticsApp()" x-show="open" @keydown.escape.window="closeModal()">
	<div class="modal-backdrop" @click="closeModal()"></div>
	<div class="modal-content">
		<div class="modal-header">
			<h2>Interview Analytics</h2>
			<button class="modal-close" @click="closeModal()">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<line x1="18" y1="6" x2="6" y2="18"/>
					<line x1="6" y1="6" x2="18" y2="18"/>
				</svg>
			</button>
		</div>
		<div class="modal-body">
			<!-- Tabs -->
			<div class="analytics-tabs">
				<button class="analytics-tab" :class="{ active: tab === 'current' }" @click="tab = 'current'">Current Attempt</button>
				<button class="analytics-tab" :class="{ active: tab === 'history' }" @click="tab = 'history'">History</button>
			</div>
			
			<!-- Current Attempt Tab -->
			<div x-show="tab === 'current'" class="tab-content">
				<div class="analytics-summary">
					<div class="summary-card">
						<div class="summary-value" x-text="currentMetrics.totalScore + '/100'">0/100</div>
						<div class="summary-label">Overall Score</div>
					</div>
					<div class="summary-card">
						<div class="summary-value" x-text="currentMetrics.averageTime + 's'">0s</div>
						<div class="summary-label">Avg. Time</div>
					</div>
					<div class="summary-card">
						<div class="summary-value" x-text="currentMetrics.questions.length">0</div>
						<div class="summary-label">Questions</div>
					</div>
				</div>
				
				<div class="questions-list">
					<h3>Question Breakdown</h3>
					<template x-for="(q, index) in currentMetrics.questions" :key="index">
						<div class="question-item" :class="q.rating">
							<div class="question-number" x-text="'Q' + (index + 1)"></div>
							<div class="question-details">
								<div class="question-text" x-text="q.question"></div>
								<div class="question-meta">
									<span class="time-badge" x-text="q.timeTaken + 's / ' + q.timeAllowed + 's'"></span>
									<span class="rating-badge" :class="q.rating" x-text="q.label"></span>
									<span class="score-badge" x-text="q.score + ' pts'"></span>
								</div>
							</div>
						</div>
					</template>
					<div x-show="currentMetrics.questions.length === 0" class="no-data">
						No questions answered yet.
					</div>
				</div>
			</div>
			
			<!-- History Tab -->
			<div x-show="tab === 'history'" class="tab-content">
				<div class="history-summary">
					<div class="summary-card">
						<div class="summary-value" x-text="historyStats.totalAttempts">0</div>
						<div class="summary-label">Total Attempts</div>
					</div>
					<div class="summary-card">
						<div class="summary-value" x-text="historyStats.passRate + '%'">0%</div>
						<div class="summary-label">Pass Rate</div>
					</div>
					<div class="summary-card">
						<div class="summary-value" x-text="historyStats.avgScore + '/100'">0/100</div>
						<div class="summary-label">Avg. Score</div>
					</div>
				</div>
				
				<div class="history-list">
					<h3>Recent Attempts</h3>
					<template x-for="(attempt, index) in attempts" :key="index">
						<div class="history-item" :class="{ passed: attempt.passed, failed: !attempt.passed }">
							<div class="history-status">
								<span x-show="attempt.passed" class="status-icon passed">✓</span>
								<span x-show="!attempt.passed" class="status-icon failed">✗</span>
							</div>
							<div class="history-details">
								<div class="history-date" x-text="formatDate(attempt.timestamp)"></div>
								<div class="history-meta">
									<span x-text="attempt.questionsAnswered + ' questions'"></span>
									<span x-text="formatSeconds(attempt.totalTime)"></span>
									<span x-text="getAttemptScore(attempt)"></span>
								</div>
							</div>
						</div>
					</template>
					<div x-show="attempts.length === 0" class="no-data">
						No previous attempts yet.
					</div>
					<button x-show="attempts.length > 0" class="clear-history-btn" @click="clearHistory()">
						Clear History
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
// Alpine.js Analytics App
function analyticsApp() {
	return {
		open: false,
		tab: 'current',
		currentMetrics: {
			questions: [],
			totalScore: 0,
			averageTime: 0,
			perfectAnswers: 0,
			quickAnswers: 0,
			longAnswers: 0
		},
		attempts: [],
		historyStats: {
			totalAttempts: 0,
			passRate: 0,
			avgScore: 0
		},
		
		init() {
			this.loadHistory();
		},
		
		loadHistory() {
			this.attempts = JSON.parse(localStorage.getItem('yc_interview_attempts') || '[]').reverse();
			this.calculateHistoryStats();
		},
		
		calculateHistoryStats() {
			if (this.attempts.length === 0) {
				this.historyStats.totalAttempts = 0;
				this.historyStats.passRate = 0;
				this.historyStats.avgScore = 0;
				return;
			}
			
			var passed = this.attempts.filter(a => a.passed).length;
			var totalScore = 0;
			var scoredAttempts = 0;
			
			this.attempts.forEach(a => {
				if (a.metrics && a.metrics.totalScore) {
					totalScore += a.metrics.totalScore;
					scoredAttempts++;
				}
			});
			
			this.historyStats.totalAttempts = this.attempts.length;
			this.historyStats.passRate = Math.round((passed / this.attempts.length) * 100);
			this.historyStats.avgScore = scoredAttempts > 0 ? Math.round(totalScore / scoredAttempts) : 0;
		},
		
		formatDate(timestamp) {
			var date = new Date(timestamp);
			return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
		},
		
		formatSeconds(seconds) {
			var mins = Math.floor(seconds / 60);
			var secs = seconds % 60;
			return mins + 'm ' + secs + 's';
		},
		
		getAttemptScore(attempt) {
			if (attempt.metrics && attempt.metrics.totalScore) {
				return attempt.metrics.totalScore + '/100';
			}
			return 'N/A';
		},
		
		closeModal() {
			this.open = false;
			$('#analytics-modal').addClass('hide');
		},
		
		clearHistory() {
			if (confirm('Are you sure you want to clear all attempt history?')) {
				localStorage.removeItem('yc_interview_attempts');
				this.attempts = [];
				this.calculateHistoryStats();
				updateAttemptCounter();
			}
		}
	};
}

function showAnalytics() {
	var modal = document.getElementById('analytics-modal');
	modal.classList.remove('hide');
	
	// Update Alpine.js data - use Alpine.$data for Alpine 3.x
	setTimeout(function() {
		if (window.Alpine && modal._x_dataStack) {
			var data = modal._x_dataStack[0];
			data.open = true;
			data.currentMetrics = attemptMetrics;
			data.loadHistory();
		}
	}, 50);
}
</script>

</body>
</html>
